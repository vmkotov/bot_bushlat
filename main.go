package main

import (
	"encoding/json"
	"log"
	"net/http"
	"os"
	"strconv"
	"time"

	tgbotapi "github.com/go-telegram-bot-api/telegram-bot-api/v5"
	"github.com/joho/godotenv"
	"github.com/vmkotov/telelog"

	"bushlatinga_bot/bot"
	"bushlatinga_bot/database"
)

// ======================================================
// –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–û–ì–†–ê–ú–ú–´
// ======================================================
func main() {
	//======================================================
	// –ë–õ–û–ö 1: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–û–ì–†–ê–ú–ú–´ –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò
	//======================================================
	log.Println("üîß –ó–∞–ø—É—Å–∫–∞—é Bushlatinga Bot v3.0 (–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)...")
	log.Println("üìÅ –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:", getCurrentDirectory())
	log.Println("üïê –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞:", time.Now().Format("2006-01-02 15:04:05 MST"))

	// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞ .env
	// .env —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —á—Ç–æ –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
	// –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: KEY=VALUE (–æ–¥–Ω–∞ –ø–∞—Ä–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É)
	if err := godotenv.Load(); err != nil {
		log.Printf("‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –§–∞–π–ª .env –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å: %v", err)
		log.Println("‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
	} else {
		log.Println("‚úÖ –§–∞–π–ª .env —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω")
	}

	// –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–æ–≤)
	logEnvVariables()

	//======================================================
	// –ë–õ–û–ö 2: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –¢–ï–õ–ï–ì–†–ê–ú –ë–û–¢–ê API
	//======================================================

	// –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
	// TELEGRAM_BOT_TOKEN –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω –æ—Ç @BotFather –≤ Telegram
	token := os.Getenv("TELEGRAM_BOT_TOKEN")
	if token == "" {
		log.Fatal("‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: TELEGRAM_BOT_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ .env —Ñ–∞–π–ª–µ")
		log.Fatal("‚ÑπÔ∏è –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ .env —Ñ–∞–π–ª")
	}

	// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Telegram Bot API
	// NewBotAPI –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ
	botAPI, err := tgbotapi.NewBotAPI(token)
	if err != nil {
		log.Fatalf("‚ùå –û–®–ò–ë–ö–ê –°–û–ó–î–ê–ù–ò–Ø –ë–û–¢–ê: %v", err)
		log.Fatal("‚ÑπÔ∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: 1) –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ 2) –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ 3) –ë–ª–æ–∫–∏—Ä–æ–≤–∫—É —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã Telegram")
	}

	// –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
	// –í —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
	debugMode := os.Getenv("DEBUG") == "true"
	botAPI.Debug = debugMode
	if debugMode {
		log.Println("üêõ –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ (DEBUG) –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
	}

	// –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
	log.Printf("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∫–∞–∫ @%s (ID: %d)", botAPI.Self.UserName, botAPI.Self.ID)
	log.Printf("‚ÑπÔ∏è –ò–º—è –±–æ—Ç–∞: %s", botAPI.Self.FirstName)
	if botAPI.Self.LastName != "" {
		log.Printf("‚ÑπÔ∏è –§–∞–º–∏–ª–∏—è –±–æ—Ç–∞: %s", botAPI.Self.LastName)
	}

	//======================================================
	// –ë–õ–û–ö 3: –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ß–ê–¢–û–í (–•–ê–†–î–ö–û–î)
	//======================================================
	// –í–ù–ò–ú–ê–ù–ò–ï: –•–∞—Ä–¥–∫–æ–¥ ID —á–∞—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
	// –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–Ω–æ—Å–∏—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ .env

	// –ß–ê–¢ A: TeleLogger - –í–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
	// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
	teleLoggerChatID := int64(-1003459160643)
	log.Printf("üéØ –ß–∞—Ç A (TeleLogger/–í–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è): %d", teleLoggerChatID)

	// –ß–ê–¢ B: MessageForwarder - –ê—Ä—Ö–∏–≤ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
	// –°—é–¥–∞ –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
	forwardChatID := int64(-1003669576601)
	log.Printf("üéØ –ß–∞—Ç B (MessageForwarder/–ê—Ä—Ö–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π): %d", forwardChatID)

	// –ß–ê–¢ C: Database Logger - –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ main, –Ω–æ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è)
	// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
	databaseLoggerChatID := int64(-1003585352063)
	log.Printf("üéØ –ß–∞—Ç C (Database Logger/–î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏): %d", databaseLoggerChatID)

	// –ß–ê–¢ D: Deploy Notifications - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–ø–ª–æ–µ
	// –°—é–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
	deployChatID := int64(-1003685049289)
	log.Printf("üéØ –ß–∞—Ç D (Deploy Notifications/–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–ø–ª–æ–µ): %d", deployChatID)

	//======================================================
	// –ë–õ–û–ö 4: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TELELOGGER
	//======================================================
	// TeleLogger –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ –≤ Telegram —á–∞—Ç
	// –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

	var teleLogger telelog.TeleLogger

	if teleLoggerChatID != 0 {
		// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TeleLogger —Å —Ö–∞—Ä–¥–∫–æ–¥–æ–º ID —á–∞—Ç–∞
		teleLogger = telelog.New(telelog.Options{
			Bot:         botAPI,               // –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ Telegram API
			LogChatID:   teleLoggerChatID,     // ID —á–∞—Ç–∞ –¥–ª—è –ª–æ–≥–æ–≤ (–ß–∞—Ç A)
			BotID:       botAPI.Self.ID,       // ID –±–æ—Ç–∞ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
			BotUsername: botAPI.Self.UserName, // –ò–º—è –±–æ—Ç–∞ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
		})
		log.Printf("‚úÖ TeleLogger –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ß–∞—Ç –ê (ID: %d)", teleLoggerChatID)

		// –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —á–∞—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
		if teleLogger.IsEnabled() {
			// –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
			testMsg := tgbotapi.NewMessage(teleLoggerChatID,
				"üîÑ *Bushlatinga Bot —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω!*\n\n"+
					"ü§ñ *–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ:*\n"+
					"‚Ä¢ –ò–º—è: @"+botAPI.Self.UserName+"\n"+
					"‚Ä¢ ID: "+strconv.FormatInt(botAPI.Self.ID, 10)+"\n"+
					"‚Ä¢ –í–µ—Ä—Å–∏—è: 3.0.0\n\n"+
					"üìä *–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:*\n"+
					"‚Ä¢ üìç –≠—Ç–æ—Ç —á–∞—Ç (A): –í–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏\n"+
					"‚Ä¢ üìç –ß–∞—Ç B: –ê—Ä—Ö–∏–≤ –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n"+
					"‚Ä¢ üìç –ß–∞—Ç C: –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î\n"+
					"‚Ä¢ üìç –ß–∞—Ç D: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–ø–ª–æ–µ –∏ —Ä–µ–ª–∏–∑–∞—Ö\n\n"+
					"‚è∞ *–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞:* "+time.Now().Format("2006-01-02 15:04:05 MST")+"\n"+
					"‚úÖ *–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!*")
			testMsg.ParseMode = "Markdown"

			// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
			if _, err := botAPI.Send(testMsg); err != nil {
				log.Printf("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ß–∞—Ç –ê %d: %v", teleLoggerChatID, err)
				log.Printf("‚ÑπÔ∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: 1) –ë–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–∞—Ç 2) –ü—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π")
			} else {
				log.Printf("‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ß–∞—Ç –ê")
			}
		}
	} else {
		// Fallback: –µ—Å–ª–∏ ID —á–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä
		teleLogger = telelog.SimpleNew()
		log.Println("‚ö†Ô∏è ID —á–∞—Ç–∞ –¥–ª—è TeleLogger —Ä–∞–≤–µ–Ω 0, –∏—Å–ø–æ–ª—å–∑—É—é –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä")
		log.Println("‚ÑπÔ∏è –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–≥–æ–≤ –≤ Telegram —É–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π TELELOGGER_CHAT_ID")
	}

	//======================================================
	// –ë–õ–û–ö 5: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ë–ê–ó–´ –î–ê–ù–ù–´–•
	//======================================================
	// –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö,
	// —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –¥—Ä—É–≥–æ–π –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

	var dbHandler *database.BotDatabaseHandler
	dbURL := os.Getenv("DATABASE_URL")

	if dbURL != "" {
		log.Println("üìä –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö...")

		// –û–ø—Ä–µ–¥–µ–ª—è–µ–º ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –±–æ—Ç–∞
		adminID := int64(266468924) // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

		// –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
		if adminEnv := os.Getenv("ADMIN_CHAT_ID"); adminEnv != "" {
			if id, err := strconv.ParseInt(adminEnv, 10, 64); err == nil {
				adminID = id
				log.Printf("üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–∑ .env: %d", adminID)
			} else {
				log.Printf("‚ö†Ô∏è –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ADMIN_CHAT_ID: %s, –∏—Å–ø–æ–ª—å–∑—É—é –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é", adminEnv)
			}
		} else {
			log.Printf("üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: %d", adminID)
		}

		// –°–æ–∑–¥–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
		var err error
		dbHandler, err = database.NewBotDatabaseHandler(adminID, dbURL)
		if err != nil {
			log.Printf("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ë–î: %v", err)
			log.Printf("‚ö†Ô∏è –ë–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –±–µ–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö")
			log.Printf("‚ÑπÔ∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: 1) –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î 2) –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å DATABASE_URL 3) –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏")
		} else {
			// –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã
			defer dbHandler.Close()
			log.Printf("‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ë–î —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
			log.Printf("‚ÑπÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –±–æ—Ç–∞: %d", adminID)
		}

			// –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
	} else {
		log.Println("‚ÑπÔ∏è DATABASE_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö")
		log.Println("‚ÑπÔ∏è –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–æ–±–∞–≤—å—Ç–µ DATABASE_URL –≤ .env —Ñ–∞–π–ª")
	}

	//======================================================
	// –ë–õ–û–ö 6: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–ï–†–ï–°–´–õ–ö–ò –°–û–û–ë–©–ï–ù–ò–ô
	//======================================================
	// MessageForwarder –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏–≤–Ω—ã–π —á–∞—Ç
	// –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

	var messageForwarder *bot.MessageForwarder

	if forwardChatID != 0 {
		messageForwarder = bot.NewMessageForwarder(botAPI, forwardChatID)
		log.Printf("‚úÖ MessageForwarder –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
		log.Printf("   üéØ –ß–∞—Ç B (–ê—Ä—Ö–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π): %d", forwardChatID)
		log.Printf("   ‚ÑπÔ∏è –í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –ø–µ—Ä–µ—Å—ã–ª–∞—Ç—å—Å—è –≤ —ç—Ç–æ—Ç —á–∞—Ç")
	} else {
		log.Println("‚ö†Ô∏è ID —á–∞—Ç–∞ –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏ —Ä–∞–≤–µ–Ω 0, MessageForwarder –Ω–µ —Å–æ–∑–¥–∞–Ω")
		log.Println("‚ÑπÔ∏è –§—É–Ω–∫—Ü–∏—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–∫–ª—é—á–µ–Ω–∞")
	}

	//======================================================
	// –ë–õ–û–ö 7: –°–û–ó–î–ê–ù–ò–ï –û–ë–†–ê–ë–û–¢–ß–ò–ö–ê –¢–ï–õ–ï–ì–†–ê–ú –í–ï–ë–•–£–ö–û–í
	//======================================================
	// TelegramHandler –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –≤–µ–±—Ö—É–∫–∏ –æ—Ç Telegram
	// –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Ö –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –º–æ–¥—É–ª—è–º

	telegramHandler := bot.NewTelegramHandler(
		botAPI,           // API –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
		dbHandler,        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
		teleLogger,       // –õ–æ–≥–≥–µ—Ä –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
		messageForwarder, // –ü–µ—Ä–µ—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∞—Ä—Ö–∏–≤
	)

	log.Println("‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Telegram –≤–µ–±—Ö—É–∫–æ–≤ —Å–æ–∑–¥–∞–Ω")
	log.Printf("‚ÑπÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞: –ë–æ—Ç=%t, –ë–î=%t, –õ–æ–≥–≥–µ—Ä=%t, –§–æ—Ä–≤–∞—Ä–¥–µ—Ä=%t",
		botAPI != nil,
		dbHandler != nil,
		teleLogger != nil,
		messageForwarder != nil)

	//======================================================
	// –ë–õ–û–ö 8: –ù–ê–°–¢–†–û–ô–ö–ê HTTP –°–ï–†–í–ï–†–ê
	//======================================================
	// –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
	// –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É –ø—É—Ç–∏ "/" –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è TelegramHandler

	http.HandleFunc("/", telegramHandler.HandleWebhook)
	log.Println("‚úÖ –ú–∞—Ä—à—Ä—É—Ç '/' –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–µ–±—Ö—É–∫–æ–≤")

	// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
	http.HandleFunc("/health", handleHealthCheck)
	http.HandleFunc("/status", handleStatusCheck)
	log.Println("‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã: /health, /status")

	// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ—Ä—Ç –¥–ª—è HTTP —Å–µ—Ä–≤–µ—Ä–∞
	port := os.Getenv("PORT")
	if port == "" {
		port = "8080"
		log.Printf("‚ö†Ô∏è PORT –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é –ø–æ—Ä—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: %s", port)
	} else {
		log.Printf("‚úÖ –ü–æ—Ä—Ç –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è: %s", port)
	}

	// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ –ø–æ—Ä—Ç
	if !isPortAvailable(port) {
		log.Printf("‚ö†Ô∏è –ü–æ—Ä—Ç %s –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º", port)
	}

	//======================================================
	// –ë–õ–û–ö 9: –û–¢–ü–†–ê–í–ö–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø –û –î–ï–ü–õ–û–ï
	//======================================================
	// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–¥—Ä–æ–±–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–ø–ª–æ–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —á–∞—Ç
	// –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π

	if deployChatID != 0 && botAPI != nil {
		sendDeployNotification(botAPI, deployChatID)
	} else {
		log.Println("‚ö†Ô∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–ø–ª–æ–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: –Ω–µ —É–∫–∞–∑–∞–Ω deployChatID –∏–ª–∏ botAPI")
	}

	//======================================================
	// –ë–õ–û–ö 10: –§–ò–ù–ê–õ–¨–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò –ó–ê–ü–£–°–ö
	//======================================================

	// –í—ã–≤–æ–¥–∏–º —Å–≤–æ–¥–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
	printFinalConfiguration(teleLoggerChatID, forwardChatID, deployChatID, port)

	// –ó–∞–ø—É—Å–∫–∞–µ–º HTTP —Å–µ—Ä–≤–µ—Ä
	// ListenAndServe –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞
	log.Printf("üåê –ó–∞–ø—É—Å–∫–∞—é HTTP —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É %s", port)
	log.Println("======================================================")
	log.Println("üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –æ–∂–∏–¥–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...")
	log.Println("‚ÑπÔ∏è –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C")
	log.Println("======================================================")

	// –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
	server := &http.Server{
		Addr:         ":" + port,
		ReadTimeout:  15 * time.Second,
		WriteTimeout: 15 * time.Second,
		IdleTimeout:  60 * time.Second,
	}

	if err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {
		log.Fatalf("‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä: %v", err)
		log.Fatal("‚ÑπÔ∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã: 1) –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç 2) –ù–µ—Ç –ø—Ä–∞–≤ 3) –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞")
	}
}

// ======================================================
// –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
// ======================================================

// getEnvOrDefault –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
func getEnvOrDefault(key, defaultValue string) string {
	if value := os.Getenv(key); value != "" {
		return value
	}
	return defaultValue
}

// getCurrentDirectory –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
// –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –ø—É—Ç—è–º–∏ –∫ —Ñ–∞–π–ª–∞–º
func getCurrentDirectory() string {
	dir, err := os.Getwd()
	if err != nil {
		return "–Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å"
	}
	return dir
}

// logEnvVariables –ª–æ–≥–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–±–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
// –ü–æ–º–æ–≥–∞–µ—Ç –≤ –æ—Ç–ª–∞–¥–∫–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
func logEnvVariables() {
	envVars := []string{
		"ENVIRONMENT",
		"BRANCH",
		"COMMIT_HASH",
		"PORT",
		"DEBUG",
		// –ù–µ –ª–æ–≥–∏—Ä—É–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: TELEGRAM_BOT_TOKEN, DATABASE_URL, ADMIN_CHAT_ID
	}

	log.Println("üìã –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:")
	for _, envVar := range envVars {
		if value := os.Getenv(envVar); value != "" {
			log.Printf("   %s=%s", envVar, value)
		}
	}
}

// isPortAvailable –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ –ø–æ—Ä—Ç –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
// –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–∞
func isPortAvailable(port string) bool {
	// –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å net.Listen
	return true
}

// sendDeployNotification –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–ø–ª–æ–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —á–∞—Ç
// –°–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Ä—Å–∏–∏, –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
func sendDeployNotification(botAPI *tgbotapi.BotAPI, chatID int64) {
	log.Println("üöÄ –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–ø–ª–æ–µ...")

	deployText := "üöÄ *–£–í–ï–î–û–ú–õ–ï–ù–ò–ï –û –î–ï–ü–õ–û–ï*\n\n" +
		"üì¶ *–í–µ—Ä—Å–∏—è:* 3.0.0\n" +
		"üîß *–û–∫—Ä—É–∂–µ–Ω–∏–µ:* " + getEnvOrDefault("ENVIRONMENT", "production") + "\n" +
		"üåø *–í–µ—Ç–∫–∞:* " + getEnvOrDefault("BRANCH", "main") + "\n" +
		"üìù *–ö–æ–º–º–∏—Ç:* " + getEnvOrDefault("COMMIT_HASH", "unknown") + "\n" +
		"üë§ *–î–µ–ø–ª–æ–π–µ—Ä:* Bushlatinga Bot\n" +
		"‚è∞ *–í—Ä–µ–º—è:* " + time.Now().Format("2006-01-02 15:04:05 MST") + "\n" +
		"ü§ñ *–ë–æ—Ç:* @" + botAPI.Self.UserName + "\n" +
		"üÜî *ID –±–æ—Ç–∞:* " + strconv.FormatInt(botAPI.Self.ID, 10) + "\n\n" +
		"üìä *–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:*\n" +
		"‚Ä¢ üìç –ß–∞—Ç –ê (" + strconv.FormatInt(-1003459160643, 10) + "): –í–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏\n" +
		"‚Ä¢ üìç –ß–∞—Ç B (" + strconv.FormatInt(-1003669576601, 10) + "): –ê—Ä—Ö–∏–≤ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n" +
		"‚Ä¢ üìç –ß–∞—Ç C (" + strconv.FormatInt(-1003585352063, 10) + "): –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü–∏–π\n" +
		"‚Ä¢ üìç –ß–∞—Ç D (" + strconv.FormatInt(chatID, 10) + "): –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–ø–ª–æ–µ\n\n" +
		"‚úÖ *–î–µ–ø–ª–æ–π —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!*\n" +
		"üìà *–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤*"

	deployMsg := tgbotapi.NewMessage(chatID, deployText)
	deployMsg.ParseMode = "Markdown"

	if _, err := botAPI.Send(deployMsg); err != nil {
		log.Printf("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–ø–ª–æ–µ –≤ —á–∞—Ç %d: %v", chatID, err)
		log.Printf("‚ÑπÔ∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: 1) –ë–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–∞—Ç 2) –ü—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π")
	} else {
		log.Printf("‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–ø–ª–æ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ß–∞—Ç D (%d)", chatID)
	}
}

// handleHealthCheck –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–≤—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞–º–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
func handleHealthCheck(w http.ResponseWriter, r *http.Request) {
	w.Header().Set("Content-Type", "application/json")
	w.WriteHeader(http.StatusOK)
	w.Write([]byte(`{"status": "healthy", "timestamp": "` + time.Now().Format(time.RFC3339) + `"}`))
}

// handleStatusCheck –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–∞—Ç—É—Å–µ –±–æ—Ç–∞
// –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
func handleStatusCheck(w http.ResponseWriter, r *http.Request) {
	w.Header().Set("Content-Type", "application/json")
	status := map[string]interface{}{
		"status":      "running",
		"version":     "3.0.0",
		"timestamp":   time.Now().Format(time.RFC3339),
		"environment": getEnvOrDefault("ENVIRONMENT", "production"),
		"uptime":      time.Since(startTime).String(),
	}

	// –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
	// –∏ –¥—Ä—É–≥–∏–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º

	json.NewEncoder(w).Encode(status)
}

// startTime –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞
var startTime = time.Now()

// printFinalConfiguration –≤—ã–≤–æ–¥–∏—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–æ—Ç–∞
// –°–ª—É–∂–∏—Ç –∏—Ç–æ–≥–æ–≤—ã–º –æ—Ç—á–µ—Ç–æ–º –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
func printFinalConfiguration(chatA, chatB, chatD int64, port string) {
	log.Println("======================================================")
	log.Println("ü§ñ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø BUSHLATINGA BOT v3.0")
	log.Println("======================================================")
	log.Println("üìä –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –õ–û–ì–û–í –ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ô:")
	log.Printf("   üìç –ß–∞—Ç –ê (TeleLogger/–í–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è): %d", chatA)
	log.Printf("   üìç –ß–∞—Ç B (Forwarder/–ê—Ä—Ö–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π): %d", chatB)
	log.Printf("   üìç –ß–∞—Ç C (DBLogger/–î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏): -1003585352063")
	log.Printf("   üìç –ß–∞—Ç D (Deploy/–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–ø–ª–æ–µ): %d", chatD)
	log.Println("üåê –°–ï–¢–ï–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò:")
	log.Printf("   üîå –ü–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞: %s", port)
	log.Printf("   üåê URL –≤–µ–±—Ö—É–∫–∞: http://[your-domain]:%s/", port)
	log.Println("‚öôÔ∏è –†–ï–ñ–ò–ú–´ –†–ê–ë–û–¢–´:")
	log.Printf("   üêõ –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏: %v", os.Getenv("DEBUG") == "true")
	log.Printf("   üè≠ –û–∫—Ä—É–∂–µ–Ω–∏–µ: %s", getEnvOrDefault("ENVIRONMENT", "production"))
	log.Println("üì¶ –í–ï–†–°–ò–Ø –ò –°–ë–û–†–ö–ê:")
	log.Printf("   üè∑Ô∏è –í–µ—Ä—Å–∏—è: 3.0.0")
	log.Printf("   üåø –í–µ—Ç–∫–∞: %s", getEnvOrDefault("BRANCH", "main"))
	log.Printf("   üìù –ö–æ–º–º–∏—Ç: %s", getEnvOrDefault("COMMIT_HASH", "unknown"))
	log.Println("======================================================")
	log.Println("‚úÖ –í–°–ï –°–ò–°–¢–ï–ú–´ –ó–ê–ü–£–©–ï–ù–´. –ë–û–¢ –ì–û–¢–û–í –ö –†–ê–ë–û–¢–ï!")
	log.Println("======================================================")
}
